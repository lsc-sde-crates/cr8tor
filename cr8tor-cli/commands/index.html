
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="CR8TOR is a data orchestration tool that is 5-Safes compliant. It is designed to help Secure Data Environment operators to manage the ingress of curated datasets from a data warehouse or lake hoouse into a ressearch workspace.
">
      
      
        <meta name="author" content="https://github.com/lsc-sde-crates">
      
      
        <link rel="canonical" href="https://lsc-sde-crates.github.io/cr8tor/cr8tor-cli/commands/">
      
      
        <link rel="prev" href="../../developer-guide/source-setup/">
      
      
        <link rel="next" href="../development/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>CLI Commands - CR8TOR - 5-Safes Compliant Data Orchestration</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cr8tor-cli-commands-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CR8TOR - 5-Safes Compliant Data Orchestration" class="md-header__button md-logo" aria-label="CR8TOR - 5-Safes Compliant Data Orchestration" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CR8TOR - 5-Safes Compliant Data Orchestration
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CLI Commands
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/lsc-sde-crates/cr8tor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../user-guide/create-new-dar-project/" class="md-tabs__link">
          
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developer-guide/orchestration-layer-setup/" class="md-tabs__link">
          
  
  Developer Guide

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Cr8tor CLI App

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../cr8tor-publisher/overview/" class="md-tabs__link">
          
  
  Cr8tor Publisher App

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../cr8tor-cookiecutter/overview/" class="md-tabs__link">
          
  
  CookieCutter Template

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../lscsde/infrastructure/" class="md-tabs__link">
          
  
  LSC SDE

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CR8TOR - 5-Safes Compliant Data Orchestration" class="md-nav__button md-logo" aria-label="CR8TOR - 5-Safes Compliant Data Orchestration" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    CR8TOR - 5-Safes Compliant Data Orchestration
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lsc-sde-crates/cr8tor" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/create-new-dar-project/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create New DAR Project
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/update-resources-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update DAR files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/orchestrate-dar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Orchestrate DAR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/approve-dar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Approve DAR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/environments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer-guide/orchestration-layer-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Orchestration layer setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer-guide/source-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Source setup
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cr8tor CLI App
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Cr8tor CLI App
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    CLI Commands
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    CLI Commands
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-workflow-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Core Workflow Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Workflow Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initiate-project" class="md-nav__link">
    <span class="md-ellipsis">
      Initiate Project
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.initiate.initiate" class="md-nav__link">
    <span class="md-ellipsis">
      initiate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="initiate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-project-ro-crate" class="md-nav__link">
    <span class="md-ellipsis">
      Create Project RO-Crate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.create.create" class="md-nav__link">
    <span class="md-ellipsis">
      create
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-ro-crate-package" class="md-nav__link">
    <span class="md-ellipsis">
      Build RO-Crate Package
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.build.build" class="md-nav__link">
    <span class="md-ellipsis">
      build
    </span>
  </a>
  
    <nav class="md-nav" aria-label="build">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validate-project-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Validate Project Metadata
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.validate.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approval-workflow-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Approval Workflow Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Approval Workflow Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sign-off-project" class="md-nav__link">
    <span class="md-ellipsis">
      Sign-Off Project
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.sign_off.sign_off" class="md-nav__link">
    <span class="md-ellipsis">
      sign_off
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sign_off">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disclosure-check" class="md-nav__link">
    <span class="md-ellipsis">
      Disclosure Check
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.disclosure.disclosure" class="md-nav__link">
    <span class="md-ellipsis">
      disclosure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-transfer-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Data Transfer Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Transfer Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stage-data-transfer" class="md-nav__link">
    <span class="md-ellipsis">
      Stage Data Transfer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.stage_transfer.stage_transfer" class="md-nav__link">
    <span class="md-ellipsis">
      stage_transfer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stage_transfer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publish-data" class="md-nav__link">
    <span class="md-ellipsis">
      Publish Data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.publish.publish" class="md-nav__link">
    <span class="md-ellipsis">
      publish
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Command Workflow
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../example_usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../branching-strategy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Branching Strategy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cr8tor Publisher App
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Cr8tor Publisher App
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cr8tor-publisher/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cr8tor-publisher/approval-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Approval Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cr8tor-publisher/metadata-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metadata Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cr8tor-publisher/publish-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publish Service
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CookieCutter Template
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            CookieCutter Template
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cr8tor-cookiecutter/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cr8tor-cookiecutter/branching-strategy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Branching Strategy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    LSC SDE
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            LSC SDE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lscsde/infrastructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lscsde/azuredatashare/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Data Share
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lscsde/deployment-to-kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploy to Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-workflow-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Core Workflow Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Workflow Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initiate-project" class="md-nav__link">
    <span class="md-ellipsis">
      Initiate Project
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.initiate.initiate" class="md-nav__link">
    <span class="md-ellipsis">
      initiate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="initiate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-project-ro-crate" class="md-nav__link">
    <span class="md-ellipsis">
      Create Project RO-Crate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.create.create" class="md-nav__link">
    <span class="md-ellipsis">
      create
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-ro-crate-package" class="md-nav__link">
    <span class="md-ellipsis">
      Build RO-Crate Package
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.build.build" class="md-nav__link">
    <span class="md-ellipsis">
      build
    </span>
  </a>
  
    <nav class="md-nav" aria-label="build">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validate-project-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Validate Project Metadata
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.validate.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#approval-workflow-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Approval Workflow Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Approval Workflow Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sign-off-project" class="md-nav__link">
    <span class="md-ellipsis">
      Sign-Off Project
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.sign_off.sign_off" class="md-nav__link">
    <span class="md-ellipsis">
      sign_off
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sign_off">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disclosure-check" class="md-nav__link">
    <span class="md-ellipsis">
      Disclosure Check
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.disclosure.disclosure" class="md-nav__link">
    <span class="md-ellipsis">
      disclosure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-transfer-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Data Transfer Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Transfer Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stage-data-transfer" class="md-nav__link">
    <span class="md-ellipsis">
      Stage Data Transfer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.stage_transfer.stage_transfer" class="md-nav__link">
    <span class="md-ellipsis">
      stage_transfer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stage_transfer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publish-data" class="md-nav__link">
    <span class="md-ellipsis">
      Publish Data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr8tor.cli.publish.publish" class="md-nav__link">
    <span class="md-ellipsis">
      publish
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Command Workflow
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="cr8tor-cli-commands-reference">CR8TOR CLI Commands Reference<a class="headerlink" href="#cr8tor-cli-commands-reference" title="Permanent link">&para;</a></h1>
<p>CR8TOR CLI provides a comprehensive set of commands to manage the entire data access request (DAR) lifecycle, from project initiation to data publication.</p>
<h2 id="core-workflow-commands">Core Workflow Commands<a class="headerlink" href="#core-workflow-commands" title="Permanent link">&para;</a></h2>
<h3 id="initiate-project">Initiate Project<a class="headerlink" href="#initiate-project" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="cr8tor.cli.initiate.initiate"></a>
    <div class="doc doc-contents first">

        <p>Initializes a new CR8 project using a specified cookiecutter template.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>template_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GitHub URL or relative path to the cr8-cookiecutter template.
                 This is prompted from the user if not provided.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>push_to_github</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to indicate if the project should be pushed to GitHub. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>git_org</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target GitHub organization name. Required if <code>push_to_github</code> is True.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>checkout</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The branch, tag, or commit to checkout from the cookiecutter template.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>project_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the project to be created. If provided, cookiecutter will skip the prompt for other values.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>environment</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target environment (DEV, TEST, PROD). Defaults to "PROD".</p>
              </div>
            </td>
            <td>
                  <code>&#39;PROD&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cr8tor_branch</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For development and debugging. Specifies the GitHub cr8tor branch to be used in the orchestration layer.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runner_os</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target runner OS for GitHub Actions workflows (Windows, Linux). Defaults to "Windows".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Windows&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>This command performs the following actions:
- Generates a new project by applying the specified cookiecutter template.
- Adds a timestamp to the context used by the template.
- If <code>push_to_github</code> is True, creates a GitHub repository under the specified organization and pushes the generated project to GitHub using the personal access token (retrieved from <code>os.getenv("GH_TOKEN")</code>).</p>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>cr8tor initiate -t https://github.com/lsc-sde-crates/cr8-cookiecutter</p>
<p>cr8tor initiate -t path-to-local-cr8-cookiecutter-dir</p>
<p>cr8tor initiate -t path-to-local-cr8-cookiecutter-dir -n "my-project" -org "lsc-sde-crates" --push</p>
<p>cr8tor initiate -t path-to-local-cr8-cookiecutter-dir -n "my-project" -org "lsc-sde-crates" -ros "Linux" --push</p>
</details>
            <details class="quote">
              <summary>Source code in <code>src/cr8tor/cli/initiate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;initiate&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">initiate</span><span class="p">(</span>
    <span class="n">template_path</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-t&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;GitHub URL or relative path to cr8-cookiecutter template&quot;</span><span class="p">,</span>
            <span class="n">prompt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">push_to_github</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">bool</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="s2">&quot;--push/--no-push&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Flag to indicate if the project should be pushed to GitHub&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">git_org</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="s2">&quot;-org&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Target github organisation name&quot;</span><span class="p">,</span>
            <span class="n">hide_input</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">checkout</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="s2">&quot;-chk&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Branch, tag or commit to checkout from cookiecutter template&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">project_name</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="s2">&quot;-n&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Name of the project to be created. This is optional and can be provided as an argument.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="s2">&quot;-e&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Target environment. Default PROD. Must be one of the three options: DEV, TEST, PROD.&quot;</span><span class="p">,</span>
            <span class="n">case_sensitive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">show_choices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PROD&quot;</span><span class="p">,</span>
    <span class="n">cr8tor_branch</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="s2">&quot;-cb&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;For developing and debugging. Provide the github cr8tor branch that should be used in orchestration layer.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">runner_os</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="s2">&quot;-ros&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Target runner OS for GitHub Actions workflows. Must be one of: Windows, Linux.&quot;</span><span class="p">,</span>
            <span class="n">case_sensitive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">show_choices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Windows&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a new CR8 project using a specified cookiecutter template.</span>

<span class="sd">    Args:</span>
<span class="sd">        template_path (str): The GitHub URL or relative path to the cr8-cookiecutter template.</span>
<span class="sd">                             This is prompted from the user if not provided.</span>
<span class="sd">        push_to_github (bool): Flag to indicate if the project should be pushed to GitHub. Defaults to False.</span>
<span class="sd">        git_org (str, optional): The target GitHub organization name. Required if `push_to_github` is True.</span>
<span class="sd">        checkout (str, optional): The branch, tag, or commit to checkout from the cookiecutter template.</span>
<span class="sd">        project_name (str, optional): The name of the project to be created. If provided, cookiecutter will skip the prompt for other values.</span>
<span class="sd">        environment (str): The target environment (DEV, TEST, PROD). Defaults to &quot;PROD&quot;.</span>
<span class="sd">        cr8tor_branch (str, optional): For development and debugging. Specifies the GitHub cr8tor branch to be used in the orchestration layer.</span>
<span class="sd">        runner_os (str): The target runner OS for GitHub Actions workflows (Windows, Linux). Defaults to &quot;Windows&quot;.</span>

<span class="sd">    This command performs the following actions:</span>
<span class="sd">    - Generates a new project by applying the specified cookiecutter template.</span>
<span class="sd">    - Adds a timestamp to the context used by the template.</span>
<span class="sd">    - If `push_to_github` is True, creates a GitHub repository under the specified organization and pushes the generated project to GitHub using the personal access token (retrieved from `os.getenv(&quot;GH_TOKEN&quot;)`).</span>

<span class="sd">    Example usage:</span>
<span class="sd">        cr8tor initiate -t https://github.com/lsc-sde-crates/cr8-cookiecutter</span>

<span class="sd">        cr8tor initiate -t path-to-local-cr8-cookiecutter-dir</span>

<span class="sd">        cr8tor initiate -t path-to-local-cr8-cookiecutter-dir -n &quot;my-project&quot; -org &quot;lsc-sde-crates&quot; --push</span>

<span class="sd">        cr8tor initiate -t path-to-local-cr8-cookiecutter-dir -n &quot;my-project&quot; -org &quot;lsc-sde-crates&quot; -ros &quot;Linux&quot; --push</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valid_environments</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DEV&quot;</span><span class="p">,</span> <span class="s2">&quot;TEST&quot;</span><span class="p">,</span> <span class="s2">&quot;PROD&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">environment</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_environments</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">BadParameter</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid environment. Choose from </span><span class="si">{</span><span class="n">valid_environments</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="n">valid_runner_os</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Windows&quot;</span><span class="p">,</span> <span class="s2">&quot;Linux&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">runner_os</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_runner_os</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">typer</span><span class="o">.</span><span class="n">BadParameter</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid runner OS. Choose from </span><span class="si">{</span><span class="n">valid_runner_os</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="n">extra_context</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;__timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(</span><span class="n">timespec</span><span class="o">=</span><span class="s2">&quot;seconds&quot;</span><span class="p">),</span>
        <span class="s2">&quot;__cr8_cc_template&quot;</span><span class="p">:</span> <span class="n">template_path</span><span class="p">,</span>
        <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">environment</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
        <span class="s2">&quot;__github_cr8tor_branch&quot;</span><span class="p">:</span> <span class="n">cr8tor_branch</span><span class="p">,</span>
        <span class="s2">&quot;runner_os&quot;</span><span class="p">:</span> <span class="n">runner_os</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Generate the project with cookiecutter</span>
    <span class="k">if</span> <span class="n">project_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">extra_context</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;project_name&quot;</span><span class="p">:</span> <span class="n">project_name</span><span class="p">})</span>
        <span class="n">extra_context</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;github_organization&quot;</span><span class="p">:</span> <span class="n">git_org</span><span class="p">})</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">project_dir</span> <span class="o">=</span> <span class="n">cookiecutter</span><span class="p">(</span>
                <span class="n">template_path</span><span class="p">,</span>
                <span class="n">checkout</span><span class="o">=</span><span class="n">checkout</span><span class="p">,</span>
                <span class="n">extra_context</span><span class="o">=</span><span class="n">extra_context</span><span class="p">,</span>
                <span class="n">no_input</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">OutputDirExistsException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Project directory already exists. Skipping creation...&quot;</span><span class="p">)</span>
            <span class="c1"># Extract folder name from exception message</span>
            <span class="n">folder_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&quot;(.*?)&quot;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">project_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="n">folder_name</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">project_dir</span> <span class="o">=</span> <span class="n">cookiecutter</span><span class="p">(</span>
                <span class="n">template_path</span><span class="p">,</span> <span class="n">checkout</span><span class="o">=</span><span class="n">checkout</span><span class="p">,</span> <span class="n">extra_context</span><span class="o">=</span><span class="n">extra_context</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">FailedHookException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Extract error message from the exception</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;VALIDATION_ERROR:&quot;</span> <span class="ow">in</span> <span class="n">error_msg</span><span class="p">:</span>
                <span class="n">validation_error</span> <span class="o">=</span> <span class="n">error_msg</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;VALIDATION_ERROR:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation failed: </span><span class="si">{</span><span class="n">validation_error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hook failed: </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">OutputDirExistsException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Project directory already exists. Skipping creation...&quot;</span><span class="p">)</span>
            <span class="c1"># Extract folder name from exception message</span>
            <span class="n">folder_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&quot;(.*?)&quot;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">project_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="n">folder_name</span>

    <span class="n">resources_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">project_dir</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;resources&quot;</span><span class="p">)</span>
    <span class="n">project_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;project.toml&quot;</span><span class="p">)</span>
    <span class="n">project_dict</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource_entity</span><span class="p">(</span>
        <span class="n">project_resource_path</span><span class="p">,</span> <span class="s2">&quot;project&quot;</span>
    <span class="p">)</span>
    <span class="n">project_info</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">ProjectProps</span><span class="p">(</span><span class="o">**</span><span class="n">project_dict</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">push_to_github</span> <span class="ow">and</span> <span class="n">git_org</span><span class="p">:</span>
        <span class="n">repo_name</span> <span class="o">=</span> <span class="n">project_info</span><span class="o">.</span><span class="n">reference</span>

        <span class="n">gh_client</span> <span class="o">=</span> <span class="n">gh_rest_api_client</span><span class="o">.</span><span class="n">GHApiClient</span><span class="p">(</span><span class="n">git_org</span><span class="p">)</span>

        <span class="c1"># Create the repository and push the project to GitHub</span>
        <span class="n">gh_rest_api_client</span><span class="o">.</span><span class="n">create_and_push_project</span><span class="p">(</span><span class="n">gh_client</span><span class="p">,</span> <span class="n">project_dir</span><span class="p">,</span> <span class="n">repo_name</span><span class="p">)</span>

        <span class="c1"># Check and create contributor teams</span>
        <span class="n">gh_rest_api_client</span><span class="o">.</span><span class="n">check_and_create_teams</span><span class="p">(</span><span class="n">gh_client</span><span class="p">,</span> <span class="n">repo_name</span><span class="p">)</span>

        <span class="c1"># Create repository environments for Signing Off experience</span>
        <span class="n">gh_rest_api_client</span><span class="o">.</span><span class="n">create_github_environments</span><span class="p">(</span><span class="n">gh_client</span><span class="p">,</span> <span class="n">repo_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><details class="warning" open="open">
<summary>Warning</summary>
<p><strong>--push</strong> argument requires a fine-grained PAT token generated in GitHub. It must be stored under local environment variable GH_TOKEN. See <a href="../../developer-guide/orchestration-layer-setup/#github-pat-token">minimum PAT token permissions defined here</a>.</p>
</details>
<h3 id="create-project-ro-crate">Create Project RO-Crate<a class="headerlink" href="#create-project-ro-crate" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="cr8tor.cli.create.create"></a>
    <div class="doc doc-contents first">

        <p>Generates the initial RO-Crate data crate within the target Cr8tor project from the specified metadata resources.</p>
<p>This command performs the following actions:
- Generates a UUID for the project.
- Builds an RO-Crate along with an RO-Crate knowledge graph.
- Packages the crate as a non-serialized BagIt Archive in the "bagit/" directory.
- If the <code>dryrun</code> option is provided, prints the crate details without writing to the "crate/" directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>agent</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The agent label triggering the validation. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>resources_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory containing resources to include in the RO-Crate. Defaults to "./resources".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./resources&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bagit_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bagit directory containing the RO-Crate data directory. Defaults to "./bagit".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./bagit&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_file</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Location of the configuration TOML file. Defaults to "./config.toml".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./config.toml&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dryrun</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, prints the crate details without writing to the "crate/" directory. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>cr8tor create -a agent_label -i path-to-resources-dir -b path-to-bagit-dir -c path-to-config-file --dryrun</p>
</details>
            <details class="quote">
              <summary>Source code in <code>src/cr8tor/cli/create.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;create&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span>
    <span class="n">agent</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The agent label triggering the validation.&quot;</span><span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">resources_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Directory containing resources to include in RO-Crate.&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./resources&quot;</span><span class="p">,</span>
    <span class="n">bagit_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Bagit directory containing RO-Crate data directory&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./bagit&quot;</span><span class="p">,</span>
    <span class="n">config_file</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Location of configuration TOML file.&quot;</span><span class="p">)</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./config.toml&quot;</span><span class="p">,</span>
    <span class="n">dryrun</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;--dryrun&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the initial RO-Crate data crate within the target Cr8tor project from the specified metadata resources.</span>

<span class="sd">    This command performs the following actions:</span>
<span class="sd">    - Generates a UUID for the project.</span>
<span class="sd">    - Builds an RO-Crate along with an RO-Crate knowledge graph.</span>
<span class="sd">    - Packages the crate as a non-serialized BagIt Archive in the &quot;bagit/&quot; directory.</span>
<span class="sd">    - If the `dryrun` option is provided, prints the crate details without writing to the &quot;crate/&quot; directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        agent (str): The agent label triggering the validation. Defaults to None.</span>
<span class="sd">        resources_dir (Path): Directory containing resources to include in the RO-Crate. Defaults to &quot;./resources&quot;.</span>
<span class="sd">        bagit_dir (Path): Bagit directory containing the RO-Crate data directory. Defaults to &quot;./bagit&quot;.</span>
<span class="sd">        config_file (Path): Location of the configuration TOML file. Defaults to &quot;./config.toml&quot;.</span>
<span class="sd">        dryrun (bool): If True, prints the crate details without writing to the &quot;crate/&quot; directory. Defaults to False.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        cr8tor create -a agent_label -i path-to-resources-dir -b path-to-bagit-dir -c path-to-config-file --dryrun</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;AGENT_USER&quot;</span><span class="p">)</span>

    <span class="n">exit_msg</span> <span class="o">=</span> <span class="s2">&quot;Create complete&quot;</span>
    <span class="n">exit_code</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">SUCCESS</span>

    <span class="n">create_start_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">project_uuid</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="s2">&quot;Project UUID is a unique auto-generated identifier on creation of the project&quot;</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PROJECT_UUID&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">exit_command</span><span class="p">(</span>
            <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">CREATE</span><span class="p">,</span>
            <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_EXECUTION_ERROR</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Missing resources directory at: </span><span class="si">{</span><span class="n">resources_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">project_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;project.toml&quot;</span><span class="p">)</span>
    <span class="n">governance</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">project_resource_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bagit_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;id&quot;</span> <span class="ow">in</span> <span class="n">governance</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">]:</span>
            <span class="n">current_rocrate_graph</span> <span class="o">=</span> <span class="n">proj_graph</span><span class="o">.</span><span class="n">ROCrateGraph</span><span class="p">(</span><span class="n">bagit_dir</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">current_rocrate_graph</span><span class="o">.</span><span class="n">is_project_action_complete</span><span class="p">(</span>
                <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">CREATE</span><span class="p">,</span>
                <span class="n">action_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">RoCrateActionType</span><span class="o">.</span><span class="n">CREATE</span><span class="p">,</span>
                <span class="n">project_id</span><span class="o">=</span><span class="n">governance</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="p">):</span>
                <span class="n">cli_utils</span><span class="o">.</span><span class="n">exit_command</span><span class="p">(</span>
                    <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">CREATE</span><span class="p">,</span>
                    <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_EXECUTION_ERROR</span><span class="p">,</span>
                    <span class="s2">&quot;Create command can only be run once on a project&quot;</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="n">governance</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">project_uuid</span><span class="p">)</span>
    <span class="n">governance</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
        <span class="s2">&quot;project_start_time&quot;</span><span class="p">,</span> <span class="n">create_start_dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">project_resources</span><span class="o">.</span><span class="n">update_resource_entity</span><span class="p">(</span>
        <span class="n">project_resource_path</span><span class="p">,</span> <span class="s2">&quot;project&quot;</span><span class="p">,</span> <span class="n">governance</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="n">project_resources</span><span class="o">.</span><span class="n">create_resource_entity</span><span class="p">(</span><span class="n">project_resource_path</span><span class="p">,</span> <span class="s2">&quot;actions&quot;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_create_action_command</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">CREATE</span><span class="p">,</span>
        <span class="n">start_time</span><span class="o">=</span><span class="n">create_start_dt</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_uuid</span><span class="p">,</span>
        <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
        <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
        <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
        <span class="n">exit_msg</span><span class="o">=</span><span class="n">exit_msg</span><span class="p">,</span>
        <span class="n">exit_code</span><span class="o">=</span><span class="n">exit_code</span><span class="p">,</span>
        <span class="n">instrument</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;APP_NAME&quot;</span><span class="p">),</span>
        <span class="n">result</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;@id&quot;</span><span class="p">:</span> <span class="n">project_uuid</span><span class="p">}],</span>
        <span class="n">dryrun</span><span class="o">=</span><span class="n">dryrun</span><span class="p">,</span>
        <span class="n">config_file</span><span class="o">=</span><span class="n">config_file</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="build-ro-crate-package">Build RO-Crate Package<a class="headerlink" href="#build-ro-crate-package" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="cr8tor.cli.build.build"></a>
    <div class="doc doc-contents first">

        <p>Builds the RO-Crate data crate for the target Cr8tor project using the specified metadata resources and configuration.</p>
<p>This command performs the following actions:
- Reads the configuration from the specified TOML file.
- Includes resources from the specified directory into the RO-Crate.
- If the <code>dryrun</code> option is provided, prints the crate details without writing to the "crate/" directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>resources_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory containing resources to include in the RO-Crate. Defaults to "./resources".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./resources&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_file</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Location of the configuration TOML file. Defaults to "./config.toml".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./config.toml&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dryrun</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, prints the crate details without writing to the "crate/" directory. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>cr8tor build -i path-to-resources-dir -c path-to-config-file --dryrun</p>
</details>
            <details class="quote">
              <summary>Source code in <code>src/cr8tor/cli/build.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;build&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span>
    <span class="n">resources_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Directory containing resources to include in RO-Crate.&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./resources&quot;</span><span class="p">,</span>
    <span class="n">config_file</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Location of configuration TOML file.&quot;</span><span class="p">)</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./config.toml&quot;</span><span class="p">,</span>
    <span class="n">dryrun</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;--dryrun&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds the RO-Crate data crate for the target Cr8tor project using the specified metadata resources and configuration.</span>

<span class="sd">    This command performs the following actions:</span>
<span class="sd">    - Reads the configuration from the specified TOML file.</span>
<span class="sd">    - Includes resources from the specified directory into the RO-Crate.</span>
<span class="sd">    - If the `dryrun` option is provided, prints the crate details without writing to the &quot;crate/&quot; directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        resources_dir (Path): Directory containing resources to include in the RO-Crate. Defaults to &quot;./resources&quot;.</span>
<span class="sd">        config_file (Path): Location of the configuration TOML file. Defaults to &quot;./config.toml&quot;.</span>
<span class="sd">        dryrun (bool): If True, prints the crate details without writing to the &quot;crate/&quot; directory. Defaults to False.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        cr8tor build -i path-to-resources-dir -c path-to-config-file --dryrun</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">###############################################################################</span>
    <span class="c1"># 1 Validate project build materials (i.e. resources/ &amp; config.toml)</span>
    <span class="c1">###############################################################################</span>

    <span class="n">config</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">DirectoryNotFoundError</span><span class="p">(</span><span class="n">resources_dir</span><span class="p">)</span>

    <span class="n">project_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;project.toml&quot;</span><span class="p">)</span>
    <span class="n">governance</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">project_resource_path</span><span class="p">)</span>

    <span class="n">access_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;access&quot;</span><span class="p">,</span> <span class="s2">&quot;access.toml&quot;</span><span class="p">)</span>
    <span class="n">access</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">access_resource_path</span><span class="p">)</span>

    <span class="c1">###############################################################################</span>
    <span class="c1"># 2 Check mandatory user-defined elements (i.e. gov, access) exists before</span>
    <span class="c1">#  pydantic model validation on fields</span>
    <span class="c1">###############################################################################</span>

    <span class="n">governance_required_keys</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;project&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;To build ro-crate &#39;project&#39; properties must be defined in resource: </span><span class="si">{</span><span class="n">project_resource_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;requesting_agent&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;To build ro-crate &#39;requesting_agent&#39; properties must be defined in resource: </span><span class="si">{</span><span class="n">project_resource_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;repository&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;To build ro-crate &#39;repository&#39; properties must be defined in resource: </span><span class="si">{</span><span class="n">project_resource_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;To build ro-crate &#39;actions&#39;list property must be defined in resource: </span><span class="si">{</span><span class="n">project_resource_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">access_required_keys</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;To build ro-crate source connection info is needed in resource: </span><span class="si">{</span><span class="n">access_resource_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;credentials&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;To build ro-crate connection credentials info is needed in resource: </span><span class="si">{</span><span class="n">access_resource_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">check_required_keys</span><span class="p">(</span><span class="n">governance</span><span class="p">,</span> <span class="n">governance_required_keys</span><span class="p">)</span>
    <span class="n">check_required_keys</span><span class="p">(</span><span class="n">access</span><span class="p">,</span> <span class="n">access_required_keys</span><span class="p">)</span>

    <span class="c1">###############################################################################</span>
    <span class="c1"># 3 Create initial Ro-Crate &amp; build contextual entities</span>
    <span class="c1">###############################################################################</span>

    <span class="n">crate</span> <span class="o">=</span> <span class="n">ROCrate</span><span class="p">(</span><span class="n">gen_preview</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Load project info and init RC &#39;Project&#39; entity</span>
    <span class="c1">#</span>

    <span class="n">project_props</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">ProjectProps</span><span class="p">(</span><span class="o">**</span><span class="n">governance</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">])</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;[cyan]Creating RO-Crate for[/cyan] - [bold magenta]</span><span class="si">{</span><span class="n">project_props</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">[/bold magenta]&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">project_entity</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">ContextEntity</span><span class="p">(</span>
        <span class="n">crate</span><span class="o">=</span><span class="n">crate</span><span class="p">,</span>
        <span class="n">identifier</span><span class="o">=</span><span class="n">project_props</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;@type&quot;</span><span class="p">:</span> <span class="s2">&quot;Project&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">project_props</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;identifier&quot;</span><span class="p">:</span> <span class="n">project_props</span><span class="o">.</span><span class="n">reference</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="n">crate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">project_entity</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Load requesting agent info and init RC &#39;Person&#39; entity</span>
    <span class="c1">#</span>
    <span class="n">requesting_agent_props</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">AgentProps</span><span class="p">(</span><span class="o">**</span><span class="n">governance</span><span class="p">[</span><span class="s2">&quot;requesting_agent&quot;</span><span class="p">])</span>
    <span class="n">person_entity</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">Person</span><span class="p">(</span>
        <span class="n">crate</span><span class="p">,</span>
        <span class="n">identifier</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;requesting-agent-</span><span class="si">{</span><span class="n">project_props</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">requesting_agent_props</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;affiliation&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;@id&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;requesting-agent-org-</span><span class="si">{</span><span class="n">project_props</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="n">aff_entity</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">ContextEntity</span><span class="p">(</span>
        <span class="n">crate</span><span class="p">,</span>
        <span class="n">identifier</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;requesting-agent-org-</span><span class="si">{</span><span class="n">project_props</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;@type&quot;</span><span class="p">:</span> <span class="s2">&quot;Organisation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">requesting_agent_props</span><span class="o">.</span><span class="n">affiliation</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">requesting_agent_props</span><span class="o">.</span><span class="n">affiliation</span><span class="o">.</span><span class="n">url</span><span class="p">),</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="n">crate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">aff_entity</span><span class="p">)</span>
    <span class="n">crate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">person_entity</span><span class="p">)</span>

    <span class="c1"># Relation definition for ro-crate metadata file only (i.e. not stored are managed in the resources)</span>
    <span class="n">project_entity</span><span class="p">[</span><span class="s2">&quot;memberOf&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;@id&quot;</span><span class="p">:</span> <span class="n">person_entity</span><span class="o">.</span><span class="n">id</span><span class="p">}]</span>

    <span class="c1">#</span>
    <span class="c1"># Load project repository info and init RC &#39;SoftwareSourceCode&#39; entity</span>
    <span class="c1">#</span>
    <span class="n">repo_props</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">SoftwareSourceCodeProps</span><span class="p">(</span><span class="o">**</span><span class="n">governance</span><span class="p">[</span><span class="s2">&quot;repository&quot;</span><span class="p">])</span>

    <span class="n">repo_entity</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">ContextEntity</span><span class="p">(</span>
        <span class="n">crate</span><span class="o">=</span><span class="n">crate</span><span class="p">,</span>
        <span class="n">identifier</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;repo-</span><span class="si">{</span><span class="n">project_props</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;@type&quot;</span><span class="p">:</span> <span class="s2">&quot;SoftwareSourceCode&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">repo_props</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">repo_props</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;codeRepository&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">repo_props</span><span class="o">.</span><span class="n">codeRepository</span><span class="si">}</span><span class="s2">cr8-</span><span class="si">{</span><span class="n">project_props</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="n">crate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">repo_entity</span><span class="p">)</span>
    <span class="n">crate</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;isBasedOn&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;@id&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;repo-</span><span class="si">{</span><span class="n">project_props</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>

    <span class="c1">#</span>
    <span class="c1"># Load access info and init RC entities</span>
    <span class="c1">#</span>

    <span class="c1"># contract_props = s.DataAccessContract(</span>
    <span class="c1">#     source=s.DatabricksSourceConnection(**access[&quot;source&quot;]),</span>
    <span class="c1">#     credentials=s.SourceAccessCredential(**access[&quot;credentials&quot;]),</span>
    <span class="c1">#     project_name=governance[&quot;project&quot;][&quot;project_name&quot;],</span>
    <span class="c1">#     project_start_time=governance[&quot;project&quot;][&quot;project_start_time&quot;],</span>
    <span class="c1">#     destination_type=governance[&quot;project&quot;][&quot;destination&quot;][&quot;type&quot;],</span>
    <span class="c1">#     destination_name=governance[&quot;project&quot;][&quot;destination&quot;][&quot;name&quot;],</span>
    <span class="c1">#     destination_format=governance[&quot;project&quot;][&quot;destination&quot;][&quot;format&quot;],</span>
    <span class="c1">#     metadata=None</span>
    <span class="c1"># )</span>
    <span class="c1"># TODO: Identify and init any RC contextual entities for describing data access</span>

    <span class="c1">###############################################################################</span>
    <span class="c1"># 4 Build data entities</span>
    <span class="c1">###############################################################################</span>

    <span class="c1">#</span>
    <span class="c1"># Governance resources</span>
    <span class="c1">#</span>

    <span class="n">crate</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span>
        <span class="n">source</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
        <span class="n">dest_path</span><span class="o">=</span><span class="s2">&quot;governance/project.toml&quot;</span><span class="p">,</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">project_props</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">project_props</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;[cyan]Validated and added file[/cyan] - [bold magenta]governance/project.toml[/bold magenta]&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Metadata resources</span>
    <span class="c1">#</span>

    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;dataset*.toml&quot;</span><span class="p">):</span>
        <span class="n">dataset_dict</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">dataset_props</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">DatasetMetadata</span><span class="p">(</span><span class="o">**</span><span class="n">dataset_dict</span><span class="p">)</span>

        <span class="n">crate</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span>
            <span class="n">source</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>
            <span class="n">dest_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;metadata/</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">dataset_props</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">dataset_props</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>

        <span class="n">hasparts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">dataset_props</span><span class="o">.</span><span class="n">staging_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">staging_entity</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">ContextEntity</span><span class="p">(</span>
                <span class="n">crate</span><span class="o">=</span><span class="n">crate</span><span class="p">,</span>
                <span class="n">identifier</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_props</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-staging&quot;</span><span class="p">,</span>
                <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;@type&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_props</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (Staging)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_props</span><span class="o">.</span><span class="n">staging_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;encodingFormat&quot;</span><span class="p">:</span> <span class="s2">&quot;application/x-duckdb&quot;</span><span class="p">,</span>  <span class="c1"># TODO: add format from project metadata</span>
                <span class="p">},</span>
            <span class="p">)</span>
            <span class="n">crate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">staging_entity</span><span class="p">)</span>
            <span class="n">hasparts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;@id&quot;</span><span class="p">:</span> <span class="n">staging_entity</span><span class="o">.</span><span class="n">id</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">dataset_props</span><span class="o">.</span><span class="n">publish_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">publish_entity</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">ContextEntity</span><span class="p">(</span>
                <span class="n">crate</span><span class="o">=</span><span class="n">crate</span><span class="p">,</span>
                <span class="n">identifier</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_props</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-publish&quot;</span><span class="p">,</span>
                <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;@type&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_props</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (Publish)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_props</span><span class="o">.</span><span class="n">publish_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;encodingFormat&quot;</span><span class="p">:</span> <span class="s2">&quot;application/x-duckdb&quot;</span><span class="p">,</span>  <span class="c1"># TODO: add format from project metadata</span>
                <span class="p">},</span>
            <span class="p">)</span>
            <span class="n">crate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">publish_entity</span><span class="p">)</span>
            <span class="n">hasparts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;@id&quot;</span><span class="p">:</span> <span class="n">publish_entity</span><span class="o">.</span><span class="n">id</span><span class="p">})</span>

        <span class="n">data_ctx_entity</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">ContextEntity</span><span class="p">(</span>
            <span class="n">crate</span><span class="o">=</span><span class="n">crate</span><span class="p">,</span>
            <span class="n">identifier</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_props</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;@type&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_props</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">dataset_props</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                <span class="s2">&quot;hasPart&quot;</span><span class="p">:</span> <span class="n">hasparts</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>

        <span class="n">crate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data_ctx_entity</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Access resources</span>
    <span class="c1">#</span>

    <span class="n">source_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">access</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;credentials&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">access</span><span class="p">[</span><span class="s2">&quot;credentials&quot;</span><span class="p">]</span>
    <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;extract_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">access</span><span class="p">[</span><span class="s2">&quot;extract_config&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;extract_config&quot;</span> <span class="ow">in</span> <span class="n">access</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">access_source</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">SourceConnectionModel</span><span class="p">(</span><span class="o">**</span><span class="n">source_data</span><span class="p">)</span>
    <span class="n">crate</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span>
        <span class="n">source</span><span class="o">=</span><span class="n">access_resource_path</span><span class="p">,</span>
        <span class="n">dest_path</span><span class="o">=</span><span class="s2">&quot;access/access.toml&quot;</span><span class="p">,</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">access_source</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">type</span><span class="p">},</span>
    <span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;[cyan]Validated and added access descriptor file[/cyan] - [bold magenta]access/access.toml[/bold magenta]&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1">###############################################################################</span>
    <span class="c1"># 5 Finalise Crate</span>
    <span class="c1">###############################################################################</span>
    <span class="n">crate</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">project_props</span><span class="o">.</span><span class="n">name</span>
    <span class="n">crate</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">project_props</span><span class="o">.</span><span class="n">description</span>
    <span class="n">crate</span><span class="o">.</span><span class="n">license</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">CrateMeta</span><span class="o">.</span><span class="n">License</span>
    <span class="n">crate</span><span class="o">.</span><span class="n">publisher</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">ContextEntity</span><span class="p">(</span>
        <span class="n">crate</span><span class="p">,</span>
        <span class="n">identifier</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">CrateMeta</span><span class="o">.</span><span class="n">Publisher</span><span class="p">,</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;@type&quot;</span><span class="p">:</span> <span class="s2">&quot;Organisation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;LSC SDE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">repo_props</span><span class="o">.</span><span class="n">codeRepository</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="n">crate</span><span class="o">.</span><span class="n">mainEntity</span> <span class="o">=</span> <span class="n">project_entity</span>

    <span class="c1">###############################################################################</span>
    <span class="c1"># 6 Process and render all action entities</span>
    <span class="c1">###############################################################################</span>

    <span class="c1">#</span>
    <span class="c1"># Check for actions</span>
    <span class="c1">#</span>

    <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">governance</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">action</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;CreateAction&quot;</span><span class="p">:</span>
            <span class="n">action_props</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">CreateActionProps</span><span class="p">(</span><span class="o">**</span><span class="n">action</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">action</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;AssessAction&quot;</span><span class="p">:</span>
            <span class="n">action_props</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">AssessActionProps</span><span class="p">(</span><span class="o">**</span><span class="n">action</span><span class="p">)</span>

        <span class="n">crate</span><span class="o">.</span><span class="n">add_action</span><span class="p">(</span>
            <span class="n">instrument</span><span class="o">=</span><span class="n">action_props</span><span class="o">.</span><span class="n">instrument</span><span class="p">,</span>
            <span class="n">identifier</span><span class="o">=</span><span class="n">action_props</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">result</span><span class="o">=</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">action_props</span><span class="o">.</span><span class="n">result</span><span class="p">],</span>
            <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;@type&quot;</span><span class="p">:</span> <span class="n">action_props</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">action_props</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;startTime&quot;</span><span class="p">:</span> <span class="n">action_props</span><span class="o">.</span><span class="n">start_time</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="s2">&quot;endTime&quot;</span><span class="p">:</span> <span class="n">action_props</span><span class="o">.</span><span class="n">end_time</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="s2">&quot;actionStatus&quot;</span><span class="p">:</span> <span class="n">action_props</span><span class="o">.</span><span class="n">action_status</span><span class="p">,</span>
                <span class="s2">&quot;agent&quot;</span><span class="p">:</span> <span class="n">action_props</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>

    <span class="c1">###############################################################################</span>
    <span class="c1"># 7 Add Ro-crate meta to bagit directory structure</span>
    <span class="c1">###############################################################################</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">dryrun</span><span class="p">:</span>
        <span class="n">bagit_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./bagit&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bagit_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">bagit_dir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">bag</span> <span class="o">=</span> <span class="n">bagit</span><span class="o">.</span><span class="n">Bag</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">bagit_dir</span><span class="p">))</span>

            <span class="c1"># Update bag info from config.toml; This does not modify the External-Identifier.</span>
            <span class="c1"># Delete and recreate the bag if the External-Identifier needs to be changed.</span>
            <span class="n">bag</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;bagit-info&quot;</span><span class="p">])</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded existing bag&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bag</span> <span class="o">=</span> <span class="n">init_bag</span><span class="p">(</span>
                <span class="n">project_id</span><span class="o">=</span><span class="n">project_props</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">bagit_dir</span><span class="o">=</span><span class="n">bagit_dir</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span>
            <span class="p">)</span>

        <span class="n">crate</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bagit_dir</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span>
        <span class="n">bag</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">manifests</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">n_payload_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bag</span><span class="o">.</span><span class="n">payload_files</span><span class="p">()))</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;[cyan]RO-Crate BagIt created at[/cyan] - [bold magenta]</span><span class="si">{</span><span class="n">bagit_dir</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">n_payload_files</span><span class="si">}</span><span class="s2"> files.[/bold magenta]&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;[bold red]Dry run option set. Crate will not be written to disk.[/bold red]</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">print_crate</span><span class="p">(</span><span class="n">crate</span><span class="o">=</span><span class="n">crate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="validate-project-metadata">Validate Project Metadata<a class="headerlink" href="#validate-project-metadata" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="cr8tor.cli.validate.validate"></a>
    <div class="doc doc-contents first">

        <p>Validate the contents of a Bagit directory containing an RO-Crate data directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>agent</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The agent label triggering the validation. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bagit_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Bagit directory containing the RO-Crate data directory.
              Defaults to "./bagit".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./bagit&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>resources_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory containing resources to include in the RO-Crate.
                  Defaults to "./resources".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./resources&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>This function performs the following:
- Validates the contents of the specified Bagit directory and its RO-Crate data directory.
- Validates access and governance metadata resources.
- Rebuilds the Bagit contents, including the RO-Crate metadata.</p>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>cr8tor validate -b <path-to-bagit-dir> -i <path-to-resources-dir></p>
</details>
            <details class="quote">
              <summary>Source code in <code>src/cr8tor/cli/validate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;validate&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span>
    <span class="n">agent</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The agent label triggering the validation.&quot;</span><span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bagit_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Bagit directory containing RO-Crate data directory&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./bagit&quot;</span><span class="p">,</span>
    <span class="n">resources_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Directory containing resources to include in RO-Crate.&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./resources&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate the contents of a Bagit directory containing an RO-Crate data directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        agent (str): The agent label triggering the validation. Defaults to None.</span>
<span class="sd">        bagit_dir (Path): The Bagit directory containing the RO-Crate data directory.</span>
<span class="sd">                          Defaults to &quot;./bagit&quot;.</span>
<span class="sd">        resources_dir (Path): The directory containing resources to include in the RO-Crate.</span>
<span class="sd">                              Defaults to &quot;./resources&quot;.</span>

<span class="sd">    This function performs the following:</span>
<span class="sd">    - Validates the contents of the specified Bagit directory and its RO-Crate data directory.</span>
<span class="sd">    - Validates access and governance metadata resources.</span>
<span class="sd">    - Rebuilds the Bagit contents, including the RO-Crate metadata.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        cr8tor validate -b &lt;path-to-bagit-dir&gt; -i &lt;path-to-resources-dir&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;AGENT_USER&quot;</span><span class="p">)</span>

    <span class="n">exit_msg</span> <span class="o">=</span> <span class="s2">&quot;Validation complete&quot;</span>
    <span class="n">exit_code</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">SUCCESS</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">access_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;access&quot;</span><span class="p">,</span> <span class="s2">&quot;access.toml&quot;</span><span class="p">)</span>
    <span class="n">project_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;project.toml&quot;</span><span class="p">)</span>
    <span class="n">project_dict</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource_entity</span><span class="p">(</span>
        <span class="n">project_resource_path</span><span class="p">,</span> <span class="s2">&quot;project&quot;</span>
    <span class="p">)</span>
    <span class="n">project_info</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">ProjectProps</span><span class="p">(</span><span class="o">**</span><span class="n">project_dict</span><span class="p">)</span>

    <span class="n">current_rocrate_graph</span> <span class="o">=</span> <span class="n">proj_graph</span><span class="o">.</span><span class="n">ROCrateGraph</span><span class="p">(</span><span class="n">bagit_dir</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">current_rocrate_graph</span><span class="o">.</span><span class="n">is_project_action_complete</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">CREATE</span><span class="p">,</span>
        <span class="n">action_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">RoCrateActionType</span><span class="o">.</span><span class="n">CREATE</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_assess_action_command</span><span class="p">(</span>
            <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">VALIDATE</span><span class="p">,</span>
            <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
            <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
            <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
            <span class="n">exit_msg</span><span class="o">=</span><span class="s2">&quot;The create command must be run on the target project before validation&quot;</span><span class="p">,</span>
            <span class="n">exit_code</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_WORKFLOW_ERROR</span><span class="p">,</span>
            <span class="n">instrument</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;METADATA_NAME&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">dataset_meta_file</span> <span class="ow">in</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;dataset_*.toml&quot;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">access</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">access_resource_path</span><span class="p">)</span>
            <span class="n">dataset_meta</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">dataset_meta_file</span><span class="p">)</span>
            <span class="n">source_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">access</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;credentials&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">access</span><span class="p">[</span><span class="s2">&quot;credentials&quot;</span><span class="p">]</span>
            <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;extract_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">access</span><span class="p">[</span><span class="s2">&quot;extract_config&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;extract_config&quot;</span> <span class="ow">in</span> <span class="n">access</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span>
            <span class="n">access_contract</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">DataContractValidateRequest</span><span class="p">(</span>
                <span class="n">project_name</span><span class="o">=</span><span class="n">project_dict</span><span class="p">[</span><span class="s2">&quot;project_name&quot;</span><span class="p">],</span>
                <span class="n">project_start_time</span><span class="o">=</span><span class="n">project_dict</span><span class="p">[</span><span class="s2">&quot;project_start_time&quot;</span><span class="p">],</span>
                <span class="n">destination</span><span class="o">=</span><span class="n">project_dict</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span>
                <span class="n">source</span><span class="o">=</span><span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span>
                <span class="n">extract_config</span><span class="o">=</span><span class="n">source_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extract_config&quot;</span><span class="p">),</span>
                <span class="n">dataset</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">DatasetMetadata</span><span class="p">(</span><span class="o">**</span><span class="n">dataset_meta</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">api</span><span class="o">.</span><span class="n">validate_access</span><span class="p">(</span><span class="n">access_contract</span><span class="p">))</span>
            <span class="n">validate_dataset_info</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">DatasetMetadata</span><span class="p">(</span><span class="o">**</span><span class="n">metadata</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_assess_action_command</span><span class="p">(</span>
                <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">VALIDATE</span><span class="p">,</span>
                <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
                <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
                <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
                <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
                <span class="n">exit_msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">exit_code</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">UNKNOWN_ERROR</span><span class="p">,</span>
                <span class="n">instrument</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;METADATA_NAME&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="n">is_valid</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">verify_tables_metadata</span><span class="p">(</span>
            <span class="n">validate_dataset_info</span><span class="o">.</span><span class="n">tables</span><span class="p">,</span> <span class="n">access_contract</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">tables</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid</span><span class="p">:</span>
            <span class="n">exit_msg</span> <span class="o">=</span> <span class="n">err</span>
            <span class="n">exit_code</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">VALIDATION_ERROR</span>
            <span class="k">break</span>

        <span class="n">merge_metadata_into_dataset</span><span class="p">(</span><span class="n">dataset_meta_file</span><span class="p">,</span> <span class="n">validate_dataset_info</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># This assumes validate can be run multiple times on a project</span>
    <span class="c1"># Ensures previous run entities for this action are cleared in &quot;actions&quot; before</span>
    <span class="c1"># actions is updated with the new action entity</span>
    <span class="c1">#</span>

    <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_assess_action_command</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">VALIDATE</span><span class="p">,</span>
        <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
        <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
        <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
        <span class="n">exit_msg</span><span class="o">=</span><span class="n">exit_msg</span><span class="p">,</span>
        <span class="n">exit_code</span><span class="o">=</span><span class="n">exit_code</span><span class="p">,</span>
        <span class="n">instrument</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;METADATA_NAME&quot;</span><span class="p">),</span>
        <span class="n">additional_type</span><span class="o">=</span><span class="s2">&quot;Semantic Validation&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="approval-workflow-commands">Approval Workflow Commands<a class="headerlink" href="#approval-workflow-commands" title="Permanent link">&para;</a></h2>
<h3 id="sign-off-project">Sign-Off Project<a class="headerlink" href="#sign-off-project" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="cr8tor.cli.sign_off.sign_off"></a>
    <div class="doc doc-contents first">

        <p>Logs sign-off metadata in the RO-Crate and verifies project sign-off in the approvals management platform (e.g., GitHub).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>agreement_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL to the project sign-off event (e.g., PR event in the project's GitHub history).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>signing_entity</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The entity that agreed to sign off the project request.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>agent</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The agent label triggering the validation. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bagit_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the Bagit directory containing the RO-Crate data directory. Defaults to "./bagit".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./bagit&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>resources_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the directory containing resources to include in the RO-Crate. Defaults to "./resources".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./resources&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>This command performs the following actions:
- Updates the project approvals metadata in the RO-Crate.
- Verifies the project sign-off in the approvals management platform.</p>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>cr8tor sign-off -agreement <url_to_approved_policy> -signing-entity <entity_name> -a <agent_label> -b <bagit_dir> -i <resources_dir></p>
</details>
            <details class="quote">
              <summary>Source code in <code>src/cr8tor/cli/sign_off.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sign-off&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sign_off</span><span class="p">(</span>
    <span class="n">agreement_url</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-agreement&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;URL to the project sign off event (i.e. PR event in project github history)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">signing_entity</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-signing-entity&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Entity that agreed to sign off the project request.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">agent</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The agent label triggering the validation.&quot;</span><span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bagit_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Bagit directory containing RO-Crate data directory&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./bagit&quot;</span><span class="p">,</span>
    <span class="n">resources_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Directory containing resources to include in RO-Crate.&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./resources&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Logs sign-off metadata in the RO-Crate and verifies project sign-off in the approvals management platform (e.g., GitHub).</span>

<span class="sd">    Args:</span>
<span class="sd">        agreement_url (str): URL to the project sign-off event (e.g., PR event in the project&#39;s GitHub history).</span>
<span class="sd">        signing_entity (str): The entity that agreed to sign off the project request.</span>
<span class="sd">        agent (str): The agent label triggering the validation. Defaults to None.</span>
<span class="sd">        bagit_dir (Path): Path to the Bagit directory containing the RO-Crate data directory. Defaults to &quot;./bagit&quot;.</span>
<span class="sd">        resources_dir (Path): Path to the directory containing resources to include in the RO-Crate. Defaults to &quot;./resources&quot;.</span>

<span class="sd">    This command performs the following actions:</span>
<span class="sd">    - Updates the project approvals metadata in the RO-Crate.</span>
<span class="sd">    - Verifies the project sign-off in the approvals management platform.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        cr8tor sign-off -agreement &lt;url_to_approved_policy&gt; -signing-entity &lt;entity_name&gt; -a &lt;agent_label&gt; -b &lt;bagit_dir&gt; -i &lt;resources_dir&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;APP_NAME&quot;</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">project_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;project.toml&quot;</span><span class="p">)</span>
    <span class="n">project_dict</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource_entity</span><span class="p">(</span>
        <span class="n">project_resource_path</span><span class="p">,</span> <span class="s2">&quot;project&quot;</span>
    <span class="p">)</span>
    <span class="n">project_info</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">ProjectProps</span><span class="p">(</span><span class="o">**</span><span class="n">project_dict</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">bagit_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">exit_command</span><span class="p">(</span>
            <span class="n">s</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">SIGN_OFF</span><span class="p">,</span>
            <span class="n">s</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_EXECUTION_ERROR</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Missing bagit directory at: </span><span class="si">{</span><span class="n">bagit_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">current_rocrate_graph</span> <span class="o">=</span> <span class="n">proj_graph</span><span class="o">.</span><span class="n">ROCrateGraph</span><span class="p">(</span><span class="n">bagit_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">current_rocrate_graph</span><span class="o">.</span><span class="n">is_project_action_complete</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">VALIDATE</span><span class="p">,</span>
        <span class="n">action_type</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">RoCrateActionType</span><span class="o">.</span><span class="n">ASSESS</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_assess_action_command</span><span class="p">(</span>
            <span class="n">command_type</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">SIGN_OFF</span><span class="p">,</span>
            <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
            <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
            <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
            <span class="n">exit_msg</span><span class="o">=</span><span class="s2">&quot;The project must be validated before sign off / approval&quot;</span><span class="p">,</span>
            <span class="n">exit_code</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_WORKFLOW_ERROR</span><span class="p">,</span>
            <span class="n">instrument</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">signing_entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">additional_type</span><span class="o">=</span><span class="s2">&quot;Sign off&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Should we verify that the approved PR URI exists here?</span>
    <span class="c1">#</span>

    <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_assess_action_command</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">SIGN_OFF</span><span class="p">,</span>
        <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
        <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
        <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
        <span class="n">exit_msg</span><span class="o">=</span><span class="s2">&quot;Sign off complete&quot;</span><span class="p">,</span>
        <span class="n">exit_code</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">,</span>
        <span class="n">instrument</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">signing_entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">additional_type</span><span class="o">=</span><span class="s2">&quot;Sign off&quot;</span><span class="p">,</span>
        <span class="n">result</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;@id&quot;</span><span class="p">:</span> <span class="n">agreement_url</span><span class="p">}],</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="disclosure-check">Disclosure Check<a class="headerlink" href="#disclosure-check" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="cr8tor.cli.disclosure.disclosure"></a>
    <div class="doc doc-contents first">

        <p>Logs disclosure metadata in the RO-Crate and verifies project disclosure in the approvals management platform (e.g., GitHub).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>agreement_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL to the project disclosure event (e.g., PR event in the project's GitHub history).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>signing_entity</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The entity that completed the disclosure check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>agent</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The agent label triggering the validation. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bagit_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the Bagit directory containing the RO-Crate data directory. Defaults to "./bagit".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./bagit&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>resources_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the directory containing resources to include in the RO-Crate. Defaults to "./resources".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./resources&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>This command performs the following actions:
- Updates the project approvals metadata in the RO-Crate.
- Verifies the project disclosure in the approvals management platform.</p>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>cr8tor disclosure -agreement <url_to_disclosure_event> -signing-entity <entity_name> -a <agent_label> -b <bagit_dir> -i <resources_dir></p>
</details>
            <details class="quote">
              <summary>Source code in <code>src/cr8tor/cli/disclosure.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;disclosure&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">disclosure</span><span class="p">(</span>
    <span class="n">agreement_url</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-agreement&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;URL to disclosure action (i.e. PR event in project github history)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">signing_entity</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-signing-entity&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Entity that completed disclosure check&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">agent</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The agent label triggering the validation.&quot;</span><span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bagit_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Bagit directory containing RO-Crate data directory&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./bagit&quot;</span><span class="p">,</span>
    <span class="n">resources_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Directory containing resources to include in RO-Crate.&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./resources&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Logs disclosure metadata in the RO-Crate and verifies project disclosure in the approvals management platform (e.g., GitHub).</span>

<span class="sd">    Args:</span>
<span class="sd">        agreement_url (str): URL to the project disclosure event (e.g., PR event in the project&#39;s GitHub history).</span>
<span class="sd">        signing_entity (str): The entity that completed the disclosure check.</span>
<span class="sd">        agent (str, optional): The agent label triggering the validation. Defaults to None.</span>
<span class="sd">        bagit_dir (Path): Path to the Bagit directory containing the RO-Crate data directory. Defaults to &quot;./bagit&quot;.</span>
<span class="sd">        resources_dir (Path): Path to the directory containing resources to include in the RO-Crate. Defaults to &quot;./resources&quot;.</span>

<span class="sd">    This command performs the following actions:</span>
<span class="sd">    - Updates the project approvals metadata in the RO-Crate.</span>
<span class="sd">    - Verifies the project disclosure in the approvals management platform.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        cr8tor disclosure -agreement &lt;url_to_disclosure_event&gt; -signing-entity &lt;entity_name&gt; -a &lt;agent_label&gt; -b &lt;bagit_dir&gt; -i &lt;resources_dir&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;AGENT_USER&quot;</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">project_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;project.toml&quot;</span><span class="p">)</span>
    <span class="n">project_dict</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource_entity</span><span class="p">(</span>
        <span class="n">project_resource_path</span><span class="p">,</span> <span class="s2">&quot;project&quot;</span>
    <span class="p">)</span>
    <span class="n">project_info</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">ProjectProps</span><span class="p">(</span><span class="o">**</span><span class="n">project_dict</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">bagit_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">exit_command</span><span class="p">(</span>
            <span class="n">s</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">DISCLOSURE_CHECK</span><span class="p">,</span>
            <span class="n">s</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_EXECUTION_ERROR</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Missing bagit directory at: </span><span class="si">{</span><span class="n">bagit_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">current_rocrate_graph</span> <span class="o">=</span> <span class="n">proj_graph</span><span class="o">.</span><span class="n">ROCrateGraph</span><span class="p">(</span><span class="n">bagit_dir</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">current_rocrate_graph</span><span class="o">.</span><span class="n">is_project_action_complete</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">STAGE_TRANSFER</span><span class="p">,</span>
        <span class="n">action_type</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">RoCrateActionType</span><span class="o">.</span><span class="n">CREATE</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_assess_action_command</span><span class="p">(</span>
            <span class="n">command_type</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">DISCLOSURE_CHECK</span><span class="p">,</span>
            <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
            <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
            <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
            <span class="n">exit_msg</span><span class="o">=</span><span class="s2">&quot;The project data must be staged before disclosure checks can be completed.&quot;</span><span class="p">,</span>
            <span class="n">exit_code</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_WORKFLOW_ERROR</span><span class="p">,</span>
            <span class="n">instrument</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">signing_entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">additional_type</span><span class="o">=</span><span class="s2">&quot;Discloure Check&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Should we verify that the disclosure PR ?</span>
    <span class="c1">#</span>

    <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_assess_action_command</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">DISCLOSURE_CHECK</span><span class="p">,</span>
        <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
        <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
        <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
        <span class="n">exit_msg</span><span class="o">=</span><span class="s2">&quot;Disclosure checks complete&quot;</span><span class="p">,</span>
        <span class="n">exit_code</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">SUCCESS</span><span class="p">,</span>
        <span class="n">instrument</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">signing_entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">additional_type</span><span class="o">=</span><span class="s2">&quot;Disclosure Check&quot;</span><span class="p">,</span>
        <span class="n">result</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;@id&quot;</span><span class="p">:</span> <span class="n">agreement_url</span><span class="p">}],</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="data-transfer-commands">Data Transfer Commands<a class="headerlink" href="#data-transfer-commands" title="Permanent link">&para;</a></h2>
<h3 id="stage-data-transfer">Stage Data Transfer<a class="headerlink" href="#stage-data-transfer" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="cr8tor.cli.stage_transfer.stage_transfer"></a>
    <div class="doc doc-contents first">

        <p>Stages the data by transferring it from the specified source to the sink TRE.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>agent</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The agent label triggering the validation. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bagit_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the Bagit directory containing the RO-Crate data directory.
              Defaults to "./bagit".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./bagit&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>resources_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the directory containing resources to include in the RO-Crate.
                  Defaults to "./resources".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./resources&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>This function prepares the data transfer for the specified CR8 project by:
- Validating the current RO-Crate graph.
- Ensuring that all necessary resources are included.</p>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>cr8tor stage-transfer -a agent_label -b path-to-bagit-dir -i path-to-resources-dir</p>
</details>
            <details class="quote">
              <summary>Source code in <code>src/cr8tor/cli/stage_transfer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;stage-transfer&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">stage_transfer</span><span class="p">(</span>
    <span class="n">agent</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The agent label triggering the validation.&quot;</span><span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bagit_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Bagit directory containing RO-Crate data directory&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./bagit&quot;</span><span class="p">,</span>
    <span class="n">resources_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Directory containing resources to include in RO-Crate.&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./resources&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stages the data by transferring it from the specified source to the sink TRE.</span>

<span class="sd">    Args:</span>
<span class="sd">        agent (str): The agent label triggering the validation. Defaults to None.</span>
<span class="sd">        bagit_dir (Path): Path to the Bagit directory containing the RO-Crate data directory.</span>
<span class="sd">                          Defaults to &quot;./bagit&quot;.</span>
<span class="sd">        resources_dir (Path): Path to the directory containing resources to include in the RO-Crate.</span>
<span class="sd">                              Defaults to &quot;./resources&quot;.</span>

<span class="sd">    This function prepares the data transfer for the specified CR8 project by:</span>
<span class="sd">    - Validating the current RO-Crate graph.</span>
<span class="sd">    - Ensuring that all necessary resources are included.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        cr8tor stage-transfer -a agent_label -b path-to-bagit-dir -i path-to-resources-dir</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;AGENT_USER&quot;</span><span class="p">)</span>

    <span class="n">exit_msg</span> <span class="o">=</span> <span class="s2">&quot;Staging transfer complete&quot;</span>
    <span class="n">exit_code</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">SUCCESS</span>
    <span class="n">staging_results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

    <span class="n">project_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;project.toml&quot;</span><span class="p">)</span>
    <span class="n">access_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;access&quot;</span><span class="p">,</span> <span class="s2">&quot;access.toml&quot;</span><span class="p">)</span>
    <span class="n">project_info</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">project_resource_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">bagit_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">exit_command</span><span class="p">(</span>
            <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">DISCLOSURE_CHECK</span><span class="p">,</span>
            <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_EXECUTION_ERROR</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Missing bagit directory at: </span><span class="si">{</span><span class="n">bagit_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">current_rocrate_graph</span> <span class="o">=</span> <span class="n">proj_graph</span><span class="o">.</span><span class="n">ROCrateGraph</span><span class="p">(</span><span class="n">bagit_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">current_rocrate_graph</span><span class="o">.</span><span class="n">is_project_action_complete</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">SIGN_OFF</span><span class="p">,</span>
        <span class="n">action_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">RoCrateActionType</span><span class="o">.</span><span class="n">ASSESS</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_create_action_command</span><span class="p">(</span>
            <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">STAGE_TRANSFER</span><span class="p">,</span>
            <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
            <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
            <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
            <span class="n">exit_msg</span><span class="o">=</span><span class="s2">&quot;The data project must have sign-off before staging the data transfer&quot;</span><span class="p">,</span>
            <span class="n">exit_code</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_WORKFLOW_ERROR</span><span class="p">,</span>
            <span class="n">instrument</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PUBLISH_NAME&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">dataset_meta_file</span> <span class="ow">in</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;dataset*.toml&quot;</span><span class="p">):</span>
        <span class="n">dataset_dict</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">dataset_meta_file</span><span class="p">)</span>
        <span class="n">dataset_props</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">DatasetMetadata</span><span class="p">(</span><span class="o">**</span><span class="n">dataset_dict</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">access</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">access_resource_path</span><span class="p">)</span>
            <span class="n">source_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">access</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">][</span><span class="s2">&quot;credentials&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">access</span><span class="p">[</span><span class="s2">&quot;credentials&quot;</span><span class="p">]</span>
            <span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;extract_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">access</span><span class="p">[</span><span class="s2">&quot;extract_config&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;extract_config&quot;</span> <span class="ow">in</span> <span class="n">access</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span>
            <span class="n">access_contract</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">DataContractTransferRequest</span><span class="p">(</span>
                <span class="n">project_name</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;project_name&quot;</span><span class="p">],</span>
                <span class="n">project_start_time</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;project_start_time&quot;</span><span class="p">],</span>
                <span class="n">destination</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span>
                <span class="n">source</span><span class="o">=</span><span class="n">source_data</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span>
                <span class="n">dataset</span><span class="o">=</span><span class="n">dataset_props</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">resp_dict</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">api</span><span class="o">.</span><span class="n">stage_transfer</span><span class="p">(</span><span class="n">access_contract</span><span class="p">))</span>
            <span class="n">resp_dict</span><span class="p">[</span><span class="s2">&quot;destination_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;destination&quot;</span><span class="p">][</span>
                <span class="s2">&quot;type&quot;</span>
            <span class="p">]</span>
            <span class="n">validate_resp</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">StageTransferPayload</span><span class="p">(</span><span class="o">**</span><span class="n">resp_dict</span><span class="p">)</span>

            <span class="c1"># TODO: Handle multiple staging locations</span>
            <span class="c1"># TODO: Add error response handler for action error property</span>

            <span class="k">if</span> <span class="n">validate_resp</span><span class="o">.</span><span class="n">data_retrieved</span><span class="p">:</span>
                <span class="n">staging_location_dict</span> <span class="o">=</span> <span class="n">validate_resp</span><span class="o">.</span><span class="n">data_retrieved</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
                <span class="n">staging_location_dict</span><span class="p">[</span><span class="s2">&quot;@id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>

                <span class="n">staging_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">staging_location_dict</span><span class="p">)</span>

                <span class="n">project_resources</span><span class="o">.</span><span class="n">create_resource_entity</span><span class="p">(</span>
                    <span class="n">dataset_meta_file</span><span class="p">,</span> <span class="s2">&quot;staging_path&quot;</span><span class="p">,</span> <span class="n">staging_location_dict</span>
                <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_create_action_command</span><span class="p">(</span>
                <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">STAGE_TRANSFER</span><span class="p">,</span>
                <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
                <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
                <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
                <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
                <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
                <span class="n">exit_msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">exit_code</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">UNKNOWN_ERROR</span><span class="p">,</span>
                <span class="n">instrument</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PUBLISH_NAME&quot;</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_create_action_command</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">STAGE_TRANSFER</span><span class="p">,</span>
        <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
        <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
        <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
        <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
        <span class="n">exit_msg</span><span class="o">=</span><span class="n">exit_msg</span><span class="p">,</span>
        <span class="n">exit_code</span><span class="o">=</span><span class="n">exit_code</span><span class="p">,</span>
        <span class="n">instrument</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PUBLISH_NAME&quot;</span><span class="p">),</span>
        <span class="n">result</span><span class="o">=</span><span class="n">staging_results</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="publish-data">Publish Data<a class="headerlink" href="#publish-data" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="cr8tor.cli.publish.publish"></a>
    <div class="doc doc-contents first">

        <p>Publishes the data by transferring it from staging to production storage, making it accessible to a TRE and/or authorised TRE workspace.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>agent</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The agent label triggering the validation. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bagit_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the Bagit directory containing the RO-Crate data directory. Defaults to "./bagit".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./bagit&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>resources_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the directory containing resources to include in the RO-Crate. Defaults to "./resources".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./resources&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>This command performs the following actions:
- Transfers the staged data to production storage.
- Ensures the data is accessible to the TRE or authorised TRE workspace.</p>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>cr8tor publish -a <agent_label> -b <path-to-bagit-dir> -i <path-to-resources-dir></p>
</details>
            <details class="quote">
              <summary>Source code in <code>src/cr8tor/cli/publish.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;publish&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">publish</span><span class="p">(</span>
    <span class="n">agent</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The agent label triggering the validation.&quot;</span><span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bagit_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Bagit directory containing RO-Crate data directory&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./bagit&quot;</span><span class="p">,</span>
    <span class="n">resources_dir</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Path</span><span class="p">,</span>
        <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Directory containing resources to include in RO-Crate.&quot;</span>
        <span class="p">),</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;./resources&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Publishes the data by transferring it from staging to production storage, making it accessible to a TRE and/or authorised TRE workspace.</span>

<span class="sd">    Args:</span>
<span class="sd">        agent (str): The agent label triggering the validation. Defaults to None.</span>
<span class="sd">        bagit_dir (Path): Path to the Bagit directory containing the RO-Crate data directory. Defaults to &quot;./bagit&quot;.</span>
<span class="sd">        resources_dir (Path): Path to the directory containing resources to include in the RO-Crate. Defaults to &quot;./resources&quot;.</span>

<span class="sd">    This command performs the following actions:</span>
<span class="sd">    - Transfers the staged data to production storage.</span>
<span class="sd">    - Ensures the data is accessible to the TRE or authorised TRE workspace.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        cr8tor publish -a &lt;agent_label&gt; -b &lt;path-to-bagit-dir&gt; -i &lt;path-to-resources-dir&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;AGENT_USER&quot;</span><span class="p">)</span>

    <span class="n">exit_msg</span> <span class="o">=</span> <span class="s2">&quot;Publish complete&quot;</span>
    <span class="n">exit_code</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">SUCCESS</span>
    <span class="n">publish_results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

    <span class="n">project_resource_path</span> <span class="o">=</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;governance&quot;</span><span class="p">,</span> <span class="s2">&quot;project.toml&quot;</span><span class="p">)</span>
    <span class="n">project_info</span> <span class="o">=</span> <span class="n">project_resources</span><span class="o">.</span><span class="n">read_resource</span><span class="p">(</span><span class="n">project_resource_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">bagit_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">exit_command</span><span class="p">(</span>
            <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">DISCLOSURE_CHECK</span><span class="p">,</span>
            <span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_EXECUTION_ERROR</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Missing bagit directory at: </span><span class="si">{</span><span class="n">bagit_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">current_rocrate_graph</span> <span class="o">=</span> <span class="n">proj_graph</span><span class="o">.</span><span class="n">ROCrateGraph</span><span class="p">(</span><span class="n">bagit_dir</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">current_rocrate_graph</span><span class="o">.</span><span class="n">is_project_action_complete</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">DISCLOSURE_CHECK</span><span class="p">,</span>
        <span class="n">action_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">RoCrateActionType</span><span class="o">.</span><span class="n">ASSESS</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_create_action_command</span><span class="p">(</span>
            <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">PUBLISH</span><span class="p">,</span>
            <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
            <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
            <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
            <span class="n">exit_msg</span><span class="o">=</span><span class="s2">&quot;The data project must have disclosure completed before publishing&quot;</span><span class="p">,</span>
            <span class="n">exit_code</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">ACTION_WORKFLOW_ERROR</span><span class="p">,</span>
            <span class="n">instrument</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PUBLISH_NAME&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="n">dataset_meta_file</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># TODO: Discuss with Piotr whether the publish function should be called per dataset or per project?</span>
    <span class="c1"># Currently assumes 1 dataset file in metadata</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">resources_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;dataset*.toml&quot;</span><span class="p">):</span>
            <span class="n">dataset_meta_file</span> <span class="o">=</span> <span class="n">f</span>
            <span class="k">break</span>

        <span class="n">publish_req</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">DataContractPublishRequest</span><span class="p">(</span>
            <span class="n">project_name</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;project_name&quot;</span><span class="p">],</span>
            <span class="n">project_start_time</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;project_start_time&quot;</span><span class="p">],</span>
            <span class="n">destination</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">resp_dict</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">api</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">publish_req</span><span class="p">))</span>
        <span class="n">resp_dict</span><span class="p">[</span><span class="s2">&quot;destination_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;destination&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
        <span class="n">validate_resp</span> <span class="o">=</span> <span class="n">schemas</span><span class="o">.</span><span class="n">PublishPayload</span><span class="p">(</span><span class="o">**</span><span class="n">resp_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">validate_resp</span><span class="o">.</span><span class="n">data_published</span><span class="p">:</span>
            <span class="n">publish_location_dict</span> <span class="o">=</span> <span class="n">validate_resp</span><span class="o">.</span><span class="n">data_published</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
            <span class="n">publish_location_dict</span><span class="p">[</span><span class="s2">&quot;@id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>

            <span class="n">publish_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">publish_location_dict</span><span class="p">)</span>

            <span class="n">project_resources</span><span class="o">.</span><span class="n">create_resource_entity</span><span class="p">(</span>
                <span class="n">dataset_meta_file</span><span class="p">,</span> <span class="s2">&quot;publish_path&quot;</span><span class="p">,</span> <span class="n">publish_location_dict</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_create_action_command</span><span class="p">(</span>
            <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">PUBLISH</span><span class="p">,</span>
            <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
            <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
            <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
            <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
            <span class="n">exit_msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">exit_code</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torReturnCode</span><span class="o">.</span><span class="n">UNKNOWN_ERROR</span><span class="p">,</span>
            <span class="n">instrument</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PUBLISH_NAME&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="n">cli_utils</span><span class="o">.</span><span class="n">close_create_action_command</span><span class="p">(</span>
        <span class="n">command_type</span><span class="o">=</span><span class="n">schemas</span><span class="o">.</span><span class="n">Cr8torCommandType</span><span class="o">.</span><span class="n">PUBLISH</span><span class="p">,</span>
        <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
        <span class="n">project_id</span><span class="o">=</span><span class="n">project_info</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">],</span>
        <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
        <span class="n">project_resource_path</span><span class="o">=</span><span class="n">project_resource_path</span><span class="p">,</span>
        <span class="n">resources_dir</span><span class="o">=</span><span class="n">resources_dir</span><span class="p">,</span>
        <span class="n">exit_msg</span><span class="o">=</span><span class="n">exit_msg</span><span class="p">,</span>
        <span class="n">exit_code</span><span class="o">=</span><span class="n">exit_code</span><span class="p">,</span>
        <span class="n">instrument</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PUBLISH_NAME&quot;</span><span class="p">),</span>
        <span class="n">result</span><span class="o">=</span><span class="n">publish_results</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="command-workflow">Command Workflow<a class="headerlink" href="#command-workflow" title="Permanent link">&para;</a></h2>
<p>The CR8TOR commands follow a specific sequence in the data access workflow:</p>
<ol>
<li><strong>initiate</strong> - Creates a new DAR project repository from cookiecutter template</li>
<li><strong>create</strong> - Initializes the project with unique identifiers and basic metadata</li>
<li><strong>build</strong> - Builds the BagIt RO-Crate package containing project metadata</li>
<li><strong>validate</strong> - Validates data source connections and retrieves metadata</li>
<li><strong>sign-off</strong> - Records approval for the validated data request</li>
<li><strong>stage-transfer</strong> - Transfers data from source to staging storage</li>
<li><strong>disclosure</strong> - Records disclosure approval for staged data</li>
<li><strong>publish</strong> - Moves data from staging to production storage</li>
</ol>
<details class="info" open="open">
<summary>Command Dependencies</summary>
<p>Each command typically depends on the successful completion of previous commands in the workflow. The CLI validates these dependencies and will exit with an error if prerequisite steps are missing.</p>
</details>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.expand", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>